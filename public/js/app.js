var app=angular.module("kickerApp",[]).config(["$httpProvider","$interpolateProvider",function(t,n){n.startSymbol("<%"),n.endSymbol("%>")}]);app.factory("User",["$http",function(t){function n(t){var n=this;return this.setData=function(t){angular.extend(this,t)},this.countGames=function(){return n.count_looses+n.count_wins+n.count_draws},this.avatarUrl=function(){return n.avatar_url?n.avatar_url:"/img/no-avatar.min.png"},t&&this.setData(t),this}return n}]),app.controller("ChartsCtrl",["$scope","$http","User",function(t,n,a){t.users=[],t.init=function(){t.loading=!0,n.get("/chart").success(function(n){angular.forEach(n,function(t,n){t.index=n+1;var e=new a(t);this.push(e)},t.users)})},t.init()}]),app.factory("GameUser",["$http","User",function(t,n){function a(t){var a=this;return this.setData=function(t){angular.extend(this,t),a.user=new n(a.user)},this.getDelta=function(){return a.rating_after-a.rating_before},this.userPointsClass=function(){return a.getDelta()>0?"win":"lose"},t&&this.setData(t),this}return a}]),app.factory("Game",["$http","GameUser",function(t,n){function a(t){var a=this;return this.setData=function(t){angular.extend(this,t);for(var e=0;e<a.games_users_a.length;e++)a.games_users_a[e]=new n(a.games_users_a[e]);for(e=0;e<a.games_users_b.length;e++)a.games_users_b[e]=new n(a.games_users_b[e])},this.gamePointClass=function(t){var n=a.team_a_points,e=a.team_b_points;return"b"===t&&(n=a.team_b_points,e=a.team_a_points),n>e?"win":e>n?"lose":"draw"},t&&this.setData(t),this}return a}]),app.controller("GamesCtrl",["$scope","$http","Game",function(t,n,a){t.games=[];var e={};t.init=function(){n.get("/").success(function(n){angular.forEach(n.data,function(t,n){var s=new a(t);this.push(s),e[s.id]=n},t.games)})},t.complain=function(s){n.get("/game/"+s+"/complain").success(function(r){n.get("/game/"+s).success(function(n){var s=new a(n),r=e[s.id];t.games[r]=s})})},t.init()}]);